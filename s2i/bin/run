#!/bin/bash

if [ -z "$JAVA_AGENT" ]; then
  export JAVA_AGENT="-javaagent:/opt/jolokia/jolokia-agent.jar=host=0.0.0.0"
fi

if [ -z "$JVM_ARGS" ]; then
  export JVM_ARGS="-Dlog4j.configuration=etc/log4j.properties"
fi

cd $JAVA_APP_DIR

echo "Environment variables:"
env | sort
echo

if [ -z "$JAVA_JAR" ]; then
  echo "executing java $JAVA_AGENT $JVM_ARGS -cp "classes:lib/*" $JAVA_MAIN $JAVA_MAIN_ARGS"
  exec java $JAVA_AGENT $JVM_ARGS -cp "classes:lib/*" $JAVA_MAIN $JAVA_MAIN_ARGS
else
  echo "executing java $JAVA_AGENT $JVM_ARGS -jar $JAVA_JAR $JAVA_MAIN_ARGS"
  exec java $JAVA_AGENT $JVM_ARGS -jar $JAVA_JAR $JAVA_MAIN_ARGS
fi
